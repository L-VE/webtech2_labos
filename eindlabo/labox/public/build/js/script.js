function checkContentVisibility(){"none"==$("#content").css("display")?$("#accountPic").hide():$("#accountPic").show(),calculatePaddingForMessages()}function calculatePaddingForMessages(){$("#questionList li div.question").each(function(){var e=parseInt($(this).height());$(".typeColorquestion").css("padding-top",10*e+"px"),$(".typeColorquestion").css("padding-bottom",10*e+"px")}),$("#questionList li div.answer").each(function(){var e=parseInt($(this).height());$(".typeColoranswer").css("padding-top",10*e+"px"),$(".typeColoranswer").css("padding-bottom",10*e+"px")})}function setHoverImage(e,s){$(e).attr("src",s)}function capitaliseFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function illegalCharsFound(e){var s=!1;return(-1!=e.indexOf(">")||-1!=e.indexOf("<"))&&(s=!0),s}function checkIfNoVotes(e){console.log("r",$(e)),console.log("e",$(e).children().find("span.voteCounter")),"0"==getTextType($(e).find(".voteCounter")[0])?($(e).find(".voteDown").prop("disabled",!0),setHoverImage($(e).find(".voteDown")[0],"../images/minus_sign_gray.png"),$(e).find(".voteDown").css("cursor","default")):($(e).find(".voteDown").prop("disabled",!1),setHoverImage($(e).find(".voteDown")[0],"../images/minus_sign_dark.png"),$(e).find(".voteDown").css("cursor","pointer"))}function createDateStringOnlyTime(e){var s=checkDate(e.getHours()),t=checkDate(e.getMinutes()),n=checkDate(e.getSeconds()),o=s+":"+t+":"+n;return o}function checkDate(e){return 10>e&&(e="0"+e),e}function checkVotingAvailibility(e,s,t,n,o,a){".voteDown"==n?($(e).data(s,a),$(e).find(n).removeClass("down"),$(e).find(n).addClass("chosenDown")):($(e).data(s,a),$(e).find(n).removeClass("up"),$(e).find(n).addClass("chosenUp"))}function setInitialVotingSituation(e){$(e).data("voteddown",!1),$(e).find(".voteDown").addClass("down"),$(e).find(".voteDown").removeClass("chosenDown"),$(e).find(".voteDown").removeClass("inactiveDown"),$(e).find(".voteDown").prop("disabled",!1),$(e).data("votedup",!1),$(e).find(".voteUp").removeClass("inactiveUp"),$(e).find(".voteUp").removeClass("chosenUp"),$(e).find(".voteUp").addClass("up"),$(e).find(".voteUp").prop("disabled",!1)}function checkIfThereArePosts(){$("ul#questionList").children().length<1?$(".posts").append("<p id='noMessages'>Currently there are no questions asked!</p>"):$("#noMessages").remove()}function voteMessage(e,s,t){client.publish("/vote",{chosenQuestion:e,voteType:s,voteValue:t})}function deleteMessage(e){client.publish("/deleteVote",{chosenQuestion:e})}function sortMessages(e,s){var t=$(".allQuestion");$(t).length>0?($(t).attr("inserted","false"),$(".allQuestion ").children().each(function(){return parseInt($(this).find(".voteCounter").text())<parseInt(s)?($(this).before(e),$(t).attr("inserted","true"),!1):void 0}),"false"==$(t).attr("inserted")&&$(t).append(e)):$(t).append(e),$(t).removeAttr("inserted")}function sortMessagesAsk(e,s){var t=$(".allCurrentQuestion");$(t).length>0?($(t).attr("inserted","false"),$(".allCurrentQuestion").children().each(function(){return parseInt($(this).find(".voteCounter").text())<parseInt(s)?($(this).before(e),$(t).attr("inserted","true"),!1):void 0}),"false"==$(t).attr("inserted")&&$(t).append(e)):$(t).append(e),$(t).removeAttr("inserted")}function sortMessagesModerator(e,s){var t=$(".moderator");$(t).length>0?($(t).attr("inserted","false"),$(".moderator").children().each(function(){return parseInt($(this).find(".voteCounter").text())<parseInt(s)?($(e).addClass("moveUp"),$(this).before(e),$(t).attr("inserted","true"),!1):void 0}),"false"==$(t).attr("inserted")&&$(t).append(e)):$(t).append(e),$(t).removeAttr("inserted")}function changeText(e,s){e.textContent&&"undefined"!=typeof e.textContent&&"NaN"!=typeof e.textContent?e.textContent=s:e.innerText=s}function getTextType(e){var s="";return s=e.textContent&&"undefined"!=typeof e.textContent&&"NaN"!=typeof e.textContent?e.textContent:e.innerText}var messageId=0,client=null,indexPagePath="";$(document).ready(function(){checkIfThereArePosts(),$("#accountPic").on("click",function(){$("#accountOptions").hasClass("moveRight")?($("#accountOptions").removeClass("moveRight"),$("#baseContent").removeClass("moveRight")):($("#accountOptions").addClass("moveRight"),$("#baseContent").addClass("moveRight"))}),$("#goBackArrow").on("click",function(){$(".errorMessage").text(""),$(".errorMessage").css("display","none"),$("#topicList").show(),$("#topicDetails").hide(),$("#goBackArrow").hide()}),$(".facebookLogin").on("click",function(){var e=$(location).attr("href");$(location).attr("href",e+"ask")}),$("#admin").on("click",function(){var e=$(location).attr("href");$(location).attr("href",e+"moderator")}),$("p.logout").on("click",function(){var e=$(location).attr("href"),s="";s=$("#wholeContainer").hasClass("moderatorAccount")?e.substr(0,e.indexOf("moderator")):e.substr(0,e.indexOf("ask")),indexPagePath=s,$(location).attr("href",s)}),calculatePaddingForMessages(),$(".moderatorAccount").on("load",function(){var e=$(location).attr("href"),s=e.substr(0,e.indexOf("moderator"));indexPagePath=s}),$(".ordinaryUser").on("load",function(){var e=$(location).attr("href"),s=e.substr(0,e.indexOf("ask"));indexPagePath=s}),client=new Faye.Client(indexPagePath+"faye/",{timeout:20});client.subscribe("/message",function(e){var s=new Date,t=createDateStringOnlyTime(s),n="<li class='questionItem animateQuestion' id='message"+messageId+"' data-votedup='false' data-voteddown='false'><div class='messageCon even "+e.chatMessageType+"'><span class='typeColor"+e.chatMessageType+"'></span><div class='messageConSec'><div class='messageDetails'><div class='profile'><img src='../images/profilePic.png' alt=''></div><div class='votes'><div class='voteInfo'><h1 class='votesNr'><span class='voteCounter'>0</span> votes</h1></div><div class='voteAction'><ul><li><span class='up voteUp'></span></li><li><span class='down voteDown'></span></li></ul></div></div></div><div class='messageContent'><div class='name'><h1>"+e.user+"</h1></div><div class='text'><h2>"+e.chat+"</h2></div><div class='time'><h3>"+t+"</h3></div></div></div></div></li>",o="<li class='questionItem animateQuestion' id='message"+messageId+"' data-votedup='false' data-voteddown='false'><div class='messageCon even "+e.chatMessageType+"'><span class='typeColor"+e.chatMessageType+"'></span><div class='messageConSec'><div class='messageDetails'><div class='profile'><img src='../images/profilePic.png' alt=''></div><div class='votes'><div class='voteInfo'><h1 class='votesNr'><span class='voteCounter'>0</span> votes</h1></div></div></div><div class='messageContent'><div class='name'><h1>"+e.user+"</h1></div><div class='text'><h2>"+e.chat+"</h2></div><div class='time'><h3>"+t+"</h3></div></div></div></div></li>",a="<li class='questionItem animateQuestion' id='message"+messageId+"' data-votedup='false' data-voteddown='false'><div class='messageCon even "+e.chatMessageType+"'><span class='typeColor"+e.chatMessageType+"'></span><div class='messageConSec'><div class='messageDetails'><div class='profile'><img src='../images/profilePic.png' alt=''></div><div class='votes'><div class='voteInfo'><h1 class='votesNr'><span class='voteCounter'>0</span> votes</h1></div><div class='deleteAction'><span class='delete'></span></div></div></div><div class='messageContent'><div class='name'><h1>"+e.user+"</h1></div><div class='text'><h2>"+e.chat+"</h2></div><div class='time'><h3>"+t+"</h3></div></div></div></div></li>";messageId++,sortMessages(o,0),sortMessagesModerator(a,0),sortMessagesAsk(n,0),calculatePaddingForMessages(),checkIfThereArePosts()});$("#submitQuestion").on("click",function(e){var s="Test",t=$("#questionField").val(),n=illegalCharsFound(t),o=illegalCharsFound(s),a=$("#sendTypes input[type='radio']:checked").val();if(""!=t&&""!=s&&void 0!=a)if(1==n||1==o)$(".errorMessage").text("Your message contains illegal characters like '< >'!"),$(".errorMessage").css("display","block");else{$(".errorMessage").text(""),$(".errorMessage").css("display","none");{client.publish("/message",{chat:t,user:s,chatMessageType:a})}$("#questionField").val("")}else $(".errorMessage").text("You must fill in both your message and a message type!"),$(".errorMessage").css("display","block");e.preventDefault()}),$("#questionList").on("click",".voteUp",function(){var e="#"+$(this).parents(".questionItem")[0].id;$(e).data("votedup")===!1&&$(e).data("voteddown")===!1?($(e).data("votedup",!0),$(e).find(".voteUp").removeClass("up"),$(e).find(".voteUp").addClass("chosenUp"),voteMessage(e,"up","1up")):$(e).data("votedup")===!1&&$(e).data("voteddown")===!0?($(e).data("votedup",!0),$(e).data("voteddown",!1),$(e).find(".voteUp").removeClass("up"),$(e).find(".voteUp").addClass("chosenUp"),$(e).find(".voteDown").removeClass("chosenDown"),$(e).find(".voteDown").addClass("down"),voteMessage(e,"up","2up")):(setInitialVotingSituation(e),voteMessage(e,"up","1down"))}),$("#questionList").on("click",".voteDown",function(){var e="#"+$(this).parents(".questionItem")[0].id;$(e).data("voteddown")===!1&&$(e).data("votedup")===!1?($(e).data("voteddown",!0),$(e).find(".voteDown").removeClass("down"),$(e).find(".voteDown").addClass("chosenDown"),voteMessage(e,"down","1down")):$(e).data("voteddown")===!1&&$(e).data("votedup")===!0?($(e).data("voteddown",!0),$(e).data("votedup",!1),$(e).find(".voteDown").removeClass("down"),$(e).find(".voteDown").addClass("chosenDown"),$(e).find(".voteUp").removeClass("chosenUp"),$(e).find(".voteUp").addClass("up"),voteMessage(e,"down","2down")):(setInitialVotingSituation(e),voteMessage(e,"down","1up"))});client.subscribe("/vote",function(e){var s=$(e.chosenQuestion).find(".voteCounter")[0],t=parseInt(getTextType(s)),n=e.voteValue;switch(n){case"1up":t++;break;case"2up":t+=2;break;case"1down":t--;break;case"2down":t-=2}changeText(s,t),$("ul#questionList").children().length>1&&(sortMessages($(e.chosenQuestion),t),sortMessagesAsk($(e.chosenQuestion),t),sortMessagesModerator($(e.chosenQuestion),t))});$("#questionList").on("click",".delete",function(){var e="#"+$(this).parents(".questionItem")[0].id;deleteMessage(e)});client.subscribe("/deleteVote",function(e){$("#questionList "+e.chosenQuestion).remove()})});