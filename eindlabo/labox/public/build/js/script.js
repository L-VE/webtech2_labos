function checkContentVisibility(){"none"==$("#content").css("display")?$("#accountPic").hide():$("#accountPic").show(),calculatePaddingForMessages()}function calculatePaddingForMessages(){$("#questionList li div.question").each(function(){var e=parseInt($(this).height());$(".typeColorquestion").css("padding-top",10*e+"px"),$(".typeColorquestion").css("padding-bottom",10*e+"px")}),$("#questionList li div.answer").each(function(){var e=parseInt($(this).height());$(".typeColoranswer").css("padding-top",10*e+"px"),$(".typeColoranswer").css("padding-bottom",10*e+"px")})}function setHoverImage(e,t){$(e).attr("src",t)}function capitaliseFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function illegalCharsFound(e){var t=!1;return(-1!=e.indexOf(">")||-1!=e.indexOf("<"))&&(t=!0),t}function checkIfNoVotes(e){console.log("r",$(e)),console.log("e",$(e).children().find("span.voteCounter")),"0"==getTextType($(e).find(".voteCounter")[0])?($(e).find(".voteDown").prop("disabled",!0),setHoverImage($(e).find(".voteDown")[0],"../images/minus_sign_gray.png"),$(e).find(".voteDown").css("cursor","default")):($(e).find(".voteDown").prop("disabled",!1),setHoverImage($(e).find(".voteDown")[0],"../images/minus_sign_dark.png"),$(e).find(".voteDown").css("cursor","pointer"))}function createDateStringOnlyTime(e){var t=checkDate(e.getHours()),s=checkDate(e.getMinutes()),n=checkDate(e.getSeconds()),a=t+":"+s+":"+n;return a}function createDateString(e){var t=checkDate(e.getDate()),s=checkDate(e.getMonth()+1),n=checkDate(e.getFullYear()),a=checkDate(e.getHours()),o=checkDate(e.getMinutes()),i=checkDate(e.getSeconds()),d=t+"/"+s+"/"+n+" ("+a+":"+o+":"+i+") ";return d}function checkDate(e){return 10>e&&(e="0"+e),e}function checkVotingAvailibility(e,t,s,n,a,o){".voteDown"==n?($(e).data(t,o),$(e).find(n).removeClass("down"),$(e).find(n).addClass("chosenDown")):($(e).data(t,o),$(e).find(n).removeClass("up"),$(e).find(n).addClass("chosenUp"))}function setInitialVotingSituation(e){$(e).data("voteddown",!1),$(e).find(".voteDown").addClass("down"),$(e).find(".voteDown").removeClass("chosenDown"),$(e).find(".voteDown").removeClass("inactiveDown"),$(e).find(".voteDown").prop("disabled",!1),$(e).data("votedup",!1),$(e).find(".voteUp").removeClass("inactiveUp"),$(e).find(".voteUp").removeClass("chosenUp"),$(e).find(".voteUp").addClass("up"),$(e).find(".voteUp").prop("disabled",!1)}function checkIfThereArePosts(){$("ul#questionList").children().length<1?$(".posts").append("<p id='noMessages'>Currently there are no questions asked!</p>"):$("#noMessages").remove()}function voteMessage(e,t,s){client.publish("/vote",{chosenQuestion:e,voteType:t,voteValue:s})}function deleteMessage(e){client.publish("/deleteVote",{chosenQuestion:e})}function sortMessages(e,t){var s=$(".allQuestion");$(s).length>0?($(s).attr("inserted","false"),$(".allQuestion ").children().each(function(){return parseInt($(this).find(".voteCounter").text())<parseInt(t)?($(this).before(e),$(s).attr("inserted","true"),!1):void 0}),"false"==$(s).attr("inserted")&&$(s).append(e)):$(s).append(e),$(s).removeAttr("inserted")}function sortMessagesAsk(e,t){var s=$(".allCurrentQuestion");$(s).length>0?($(s).attr("inserted","false"),$(".allCurrentQuestion").children().each(function(){return parseInt($(this).find(".voteCounter").text())<parseInt(t)?($(this).before(e),$(s).attr("inserted","true"),!1):void 0}),"false"==$(s).attr("inserted")&&$(s).append(e)):$(s).append(e),$(s).removeAttr("inserted")}function sortMessagesModerator(e,t){var s=$(".moderator");$(s).length>0?($(s).attr("inserted","false"),$(".moderator").children().each(function(){return parseInt($(this).find(".voteCounter").text())<parseInt(t)?($(e).addClass("moveUp"),$(this).before(e),$(s).attr("inserted","true"),!1):void 0}),"false"==$(s).attr("inserted")&&$(s).append(e)):$(s).append(e),$(s).removeAttr("inserted")}function changeText(e,t){e.textContent&&"undefined"!=typeof e.textContent&&"NaN"!=typeof e.textContent?e.textContent=t:e.innerText=t}function getTextType(e){var t="";return t=e.textContent&&"undefined"!=typeof e.textContent&&"NaN"!=typeof e.textContent?e.textContent:e.innerText}function uniqId(){var e=Math.round(messageId+Math.random()*maxRandomIdGenerator);return e}var messageId=0,client=null,indexPagePath="",maxRandomIdGenerator=589;$(document).ready(function(){checkIfThereArePosts(),$("#accountPic").on("click",function(){$("#accountOptions").hasClass("moveRight")?($("#accountOptions").removeClass("moveRight"),$("#baseContent").removeClass("moveRight")):($("#accountOptions").addClass("moveRight"),$("#baseContent").addClass("moveRight"))}),$("#goBackArrow").on("click",function(){$(".errorMessage").text(""),$(".errorMessage").css("display","none"),$("#topicList").show(),$("#topicDetails").hide(),$("#goBackArrow").hide()}),$(".facebookLogin").on("click",function(){var e=$(location).attr("href");$(location).attr("href",e+"ask")}),$("#admin").on("click",function(){var e=$(location).attr("href");$(location).attr("href",e+"moderator")}),$("p.logout").on("click",function(){var e=$(location).attr("href"),t="";t=$("#wholeContainer").hasClass("moderatorAccount")?e.substr(0,e.indexOf("moderator")):e.substr(0,e.indexOf("ask")),indexPagePath=t,$(location).attr("href",t)}),calculatePaddingForMessages(),$(".moderatorAccount").on("load",function(){var e=$(location).attr("href"),t=e.substr(0,e.indexOf("moderator"));indexPagePath=t}),$(".ordinaryUser").on("load",function(){var e=$(location).attr("href"),t=e.substr(0,e.indexOf("ask"));indexPagePath=t}),client=new Faye.Client(indexPagePath+"faye/",{timeout:20});client.subscribe("/message",function(e){var t="<li id='"+e.id+"' data-votedup='false' data-voteddown='false' class='questionItem animateQuestion'><div class='messageCon even "+e.chatMessageType+"'><span class='typeColor"+e.chatMessageType+"'></span><div class='messageConSec'><div class='messageDetails'><div class='profile'><img src='../images/profilePic.png' alt=''></div><div class='votes'><div class='voteInfo'><h1 class='votesNr'><span class='voteCounter'>0</span> votes</h1></div><div class='voteAction'><ul><li><span class='up voteUp'></span></li><li><span class='down voteDown'></span></li></ul></div></div></div><div class='messageContent'><div class='name'><h1>"+e.user+"</h1></div><div class='text'><h2>"+e.chat+"</h2></div><div class='time'><h3>"+e.chatTime+"</h3></div></div></div></div></li>",s="<li id='"+e.id+"' data-votedup='false' data-voteddown='false' class='questionItem animateQuestion'><div class='messageCon even "+e.chatMessageType+"'><span class='typeColor"+e.chatMessageType+"'></span><div class='messageConSec'><div class='messageDetails'><div class='profile'><img src='../images/profilePic.png' alt=''></div><div class='votes'><div class='voteInfo'><h1 class='votesNr'><span class='voteCounter'>0</span> votes</h1></div></div></div><div class='messageContent'><div class='name'><h1>"+e.user+"</h1></div><div class='text'><h2>"+e.chat+"</h2></div><div class='time'><h3>"+e.chatTime+"</h3></div></div></div></div></li>",n="<li id='"+e.id+"' data-votedup='false' data-voteddown='false' class='questionItem animateQuestion'><div class='messageCon even "+e.chatMessageType+"'><span class='typeColor"+e.chatMessageType+"'></span><div class='messageConSec'><div class='messageDetails'><div class='profile'><img src='../images/profilePic.png' alt=''></div><div class='votes'><div class='voteInfo'><h1 class='votesNr'><span class='voteCounter'>0</span> votes</h1></div><div class='deleteAction'><span class='delete'></span></div></div></div><div class='messageContent'><div class='name'><h1>"+e.user+"</h1></div><div class='text'><h2>"+e.chat+"</h2></div><div class='time'><h3>"+e.chatTime+"</h3></div></div></div></div></li>";sortMessages(s,0),sortMessagesModerator(n,0),sortMessagesAsk(t,0),calculatePaddingForMessages(),checkIfThereArePosts()});$("#submitQuestion").on("click",function(e){e.preventDefault();var t="Test",s=$("#questionField").val(),n=illegalCharsFound(s),a=illegalCharsFound(t),o=$("#sendTypes input[type='radio']:checked").val(),i=new Date,d=createDateString(i);if(""!=s&&""!=t&&void 0!=o)if(1==n||1==a)$(".errorMessage").text("Your message contains illegal characters like '< >'!"),$(".errorMessage").css("display","block");else{$(".errorMessage").text(""),$(".errorMessage").css("display","none");var r=parseInt(getTextType($("span.hiddenMessageCount")[0]));r++;{var c={id:r,message:s,sender:t,chatType:o,chatTime:i};client.publish("/message",{id:"message"+r,chat:s,user:t,chatMessageType:o,chatTime:d})}$("#questionField").val("");{$.ajax({data:{chatContent:c},type:"POST",url:"/create",dataType:"json",error:function(){console.log("Kon de actie niet uitvoeren."),e.preventDefault()},success:function(){console.log("geluktsucces"),e.preventDefault()}})}}else $(".errorMessage").text("You must fill in both your message and a message type!"),$(".errorMessage").css("display","block")}),$("#questionList").on("click",".voteUp",function(){var e="#"+$(this).parents(".questionItem")[0].id;$(e).data("votedup")===!1&&$(e).data("voteddown")===!1?($(e).data("votedup",!0),$(e).find(".voteUp").removeClass("up"),$(e).find(".voteUp").addClass("chosenUp"),voteMessage(e,"up","1up")):$(e).data("votedup")===!1&&$(e).data("voteddown")===!0?($(e).data("votedup",!0),$(e).data("voteddown",!1),$(e).find(".voteUp").removeClass("up"),$(e).find(".voteUp").addClass("chosenUp"),$(e).find(".voteDown").removeClass("chosenDown"),$(e).find(".voteDown").addClass("down"),voteMessage(e,"up","2up")):(setInitialVotingSituation(e),voteMessage(e,"up","1down"))}),$("#questionList").on("click",".voteDown",function(){var e="#"+$(this).parents(".questionItem")[0].id;$(e).data("voteddown")===!1&&$(e).data("votedup")===!1?($(e).data("voteddown",!0),$(e).find(".voteDown").removeClass("down"),$(e).find(".voteDown").addClass("chosenDown"),voteMessage(e,"down","1down")):$(e).data("voteddown")===!1&&$(e).data("votedup")===!0?($(e).data("voteddown",!0),$(e).data("votedup",!1),$(e).find(".voteDown").removeClass("down"),$(e).find(".voteDown").addClass("chosenDown"),$(e).find(".voteUp").removeClass("chosenUp"),$(e).find(".voteUp").addClass("up"),voteMessage(e,"down","2down")):(setInitialVotingSituation(e),voteMessage(e,"down","1up"))});client.subscribe("/vote",function(e){var t=$(e.chosenQuestion).find(".voteCounter")[0],s=e.chosenQuestion;alert(s);var n="#message",a=n.length,o=s.substr(a,s.length),i=parseInt(getTextType(t)),d=e.voteValue;switch(d){case"1up":i++;break;case"2up":i+=2;break;case"1down":i--;break;case"2down":i-=2}changeText(t,i);$.ajax({type:"POST",url:"/vote/"+o+"/"+i,dataType:"json",error:function(){event.preventDefault()},success:function(){event.preventDefault()}});$("ul#questionList").children().length>1&&(sortMessages($(e.chosenQuestion),i),sortMessagesAsk($(e.chosenQuestion),i),sortMessagesModerator($(e.chosenQuestion),i))});$("#questionList").on("click",".delete",function(e){{var t="#"+$(this).parents(".questionItem")[0].id,s=$(this).parents(".questionItem")[0].id,n="message",a=n.length,o=s.substr(a,s.length);$.ajax({type:"POST",url:"/destroy/"+o,dataType:"json",error:function(){e.preventDefault()},success:function(){deleteMessage(t),e.preventDefault()}})}});client.subscribe("/deleteVote",function(e){$("#questionList "+e.chosenQuestion).remove()})});